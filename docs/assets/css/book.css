/* Book Psychoanalytic Theme — base styles */
*, *::before, *::after { box-sizing: border-box; }
html { 
  -webkit-text-size-adjust: 100%; 
  text-size-adjust: 100%; 
  scroll-behavior: smooth; 
}
:root {
  --page-bg: #F4EFE6;           /* warm paper */
  --ink: #1B1F2A;               /* primary text (ink) */
  --secondary-ink: #2E3245;     /* headings */
  --muted: #5C6270;             /* secondary */
  --accent: #D2BFAB;            /* accent shared with внутренних страниц */
  --accent-soft: #F6E7D6;       /* pastel peach */
  --accent-sage: #D7E2D6;       /* sage tint */
  --accent-blue: #D6E6EE;       /* light blue tint */
  --accent-ink: #1E2430;        /* readable text on accent */
  --link: #4B5BA9;              /* links */
  --cta-green: #88BE9C;         /* soft green for buttons */
  --cta-green-dark: #6EA782;    /* darker hover state */
  --paper-shadow: rgba(0,0,0,.06);
  --page-width: 72ch;
  --line: 1.72;
}
body {
  margin: 0;
  color: var(--ink);
  background:
    radial-gradient(circle at 10% 20%, rgba(214,230,218,.25), transparent 55%),
    radial-gradient(circle at 90% 0%, rgba(228,239,247,.22), transparent 60%),
    var(--page-bg);
  font-family: "Literata", "Merriweather", Georgia, "Times New Roman", serif;
  line-height: var(--line);
  letter-spacing: .01em;
  -webkit-font-smoothing: antialiased;
  font-kerning: normal;
  hanging-punctuation: first last;
}
a { color: var(--link); text-decoration: none; }
a:hover { text-decoration: underline; }
img { max-width: 100%; height: auto; }
.muted { color: var(--muted); }
blockquote {
  margin: 0 0 1rem;
  padding-left: 1.25rem;
  border-left: 2px solid color-mix(in oklab, var(--accent), transparent 40%);
  font-style: italic;
  color: var(--muted);
}

.quote-card {
  position: relative;
  margin: 1.75rem 0 0;
  padding: 1.25rem 1.4rem 1.35rem;
  border-radius: .65rem;
  background: color-mix(in oklab, #fff 70%, var(--accent) 30%);
  border: 1px solid rgba(0,0,0,.04);
  box-shadow: 0 32px 40px -36px rgba(0,0,0,.35);
  font-style: italic;
  color: var(--secondary-ink);
}
.quote-card::before {
  content: "«";
  position: absolute;
  top: .2rem;
  left: 1rem;
  font-size: 3rem;
  line-height: 1;
  color: color-mix(in oklab, var(--accent), #fff 35%);
  opacity: .45;
  pointer-events: none;
}
.quote-card p {
  margin: 0;
}
.quote-card .quote-author {
  margin-top: .85rem;
  font-style: normal;
  font-size: .95rem;
  color: var(--muted);
  text-transform: none;
  letter-spacing: normal;
}
.quote-card--inline {
  background: color-mix(in oklab, #fff 85%, var(--page-bg) 15%);
  box-shadow: 0 20px 30px -34px rgba(0,0,0,.35);
}

/* Book container */
.book {
  max-width: calc(var(--page-width) + 40ch);
  margin: 0 auto;
  padding: 0 2rem 6rem;
  position: relative;
}
.book::before, .book::after {
  content: "";
  position: absolute;
  top: 0; bottom: 0;
  width: 12px;
  filter: blur(1px);
  background: repeating-linear-gradient(
    to bottom,
    rgba(0,0,0,.02) 0 2px,
    transparent 2px 4px
  );
  opacity: .4;
  pointer-events: none;
}
.book::before { left: 0; box-shadow: 12px 0 24px -12px var(--paper-shadow) inset; }
.book::after  { right: 0; box-shadow: -12px 0 24px -12px var(--paper-shadow) inset; }

/* Header / cover */
.header {
  max-width: var(--page-width);
  margin: 0 auto;
  padding: 3rem 0 2rem;
  position: relative;
}
.brand { font-family: "Playfair Display", "Garamond", serif; letter-spacing: .03em; }
.brand a { color: inherit; }
.header .brand { font-size: clamp(1.2rem, 1.6vw + .8rem, 1.8rem); font-weight: 600; }
.header-cta {
  margin-top: 1rem;
  display: flex;
  align-items: center;
  gap: .75rem;
  flex-wrap: wrap;
}
.cta-buttons {
  display: flex;
  align-items: center;
  gap: .75rem;
  flex-wrap: wrap;
}
.btn-whatsapp {
  background: #25D366;
  border-color: color-mix(in oklab, #1faa54, transparent 40%);
}
.btn-whatsapp:hover,
.btn-whatsapp:focus-visible {
  background: #1faa54;
}
.btn-telegram {
  background: #229ED9;
  border-color: color-mix(in oklab, #1b86b8, transparent 40%);
}
.btn-telegram:hover,
.btn-telegram:focus-visible {
  background: #1b86b8;
}
.contact-phone {
  font-weight: 700;
  color: var(--secondary-ink);
  text-decoration: none;
  font-variant-numeric: tabular-nums;
}
.contact-phone:hover { text-decoration: underline; }
.cover {
  max-width: var(--page-width);
  margin: 2.5rem auto 4rem;
  padding: 2.5rem 2rem;
  background: linear-gradient(180deg, rgba(255,255,255,.65), rgba(255,255,255,.35));
  border-radius: .5rem;
  box-shadow: 0 40px 60px -40px var(--paper-shadow), 0 1px 0 rgba(255,255,255,.35) inset;
  position: relative;
  overflow: visible;
  isolation: isolate;
}
.cover::before {
  content: "";
  position: absolute;
  inset: -8% -6% auto auto;
  width: clamp(220px, 42vw, 460px);
  height: clamp(180px, 30vw, 340px);
  background:
    radial-gradient(circle at 10% 20%, rgba(246,231,214,.55), transparent 60%),
    radial-gradient(circle at 80% 60%, rgba(215,226,214,.4), transparent 62%),
    radial-gradient(circle at 50% 0%, rgba(214,230,238,.35), transparent 60%);
  filter: blur(2px);
  opacity: .75;
  pointer-events: none;
  z-index: -1;
}
.cover h1 {
  margin: 0 0 .6rem;
  font-family: "Playfair Display", "Garamond", serif;
  font-weight: 400;
  font-size: clamp(1.8rem, 4.6vw + .8rem, 3.4rem);
  color: var(--secondary-ink);
}
.dropcap {
  float: left;
  font-family: "Playfair Display", "Garamond", serif;
  font-size: clamp(3.2rem, 6vw, 4.2rem);
  line-height: .9;
  margin-right: .2rem;
  color: color-mix(in oklab, var(--secondary-ink), var(--accent) 35%);
}
.book h2,
.book h3,
.book h4 {
  font-family: "Playfair Display", "Garamond", serif;
}

.chapter .content > p:first-of-type::first-letter {
  float: left;
  font-family: "Playfair Display", "Garamond", serif;
  font-size: clamp(2.4rem, 3vw + 1rem, 3.2rem);
  line-height: .9;
  margin: .05rem .35rem 0 0;
  color: color-mix(in oklab, var(--secondary-ink), var(--accent) 30%);
}
.quote-card p::first-letter,
blockquote p::first-letter,
.sticker::first-letter {
  float: none;
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
  margin: 0;
  color: inherit;
}
.cover p.lead {
  margin: 0;
  font-size: clamp(1rem, .6vw + .9rem, 1.25rem);
  color: var(--muted);
}
.subtitle {
  margin: 0 0 .5rem;
  font-size: clamp(1.05rem, .9vw + 1rem, 1.3rem);
  color: color-mix(in oklab, var(--secondary-ink), var(--accent) 35%);
  font-weight: 600;
}
.cover .inkblot {
  position: absolute;
  right: -6%;
  bottom: -8%;
  width: clamp(220px, 40vw, 520px);
  mix-blend-mode: multiply;
  opacity: .18;
  transform: rotate(-2deg);
  pointer-events: none;
}

.intro-video {
  margin: 1.5rem 0 0;
  padding: 1rem 1.1rem 1.2rem;
  border-radius: .9rem;
  background: color-mix(in oklab, #fff 75%, var(--accent-soft) 25%);
  border: 1px solid rgba(0,0,0,.04);
  box-shadow: 0 28px 42px -36px rgba(0,0,0,.4);
}

.intro-video__frame {
  position: relative;
  padding-top: min(56.25%, 360px);
  overflow: hidden;
  border-radius: .75rem;
  background: rgba(0,0,0,.02);
}

.intro-video iframe {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  border: none;
  border-radius: .75rem;
}

.intro-video .muted {
  margin: .65rem 0 0;
  font-size: .95rem;
}

.tagline {
  margin: 1.2rem 0 0;
  font-size: clamp(1rem, .8vw + .8rem, 1.25rem);
  font-style: italic;
  color: var(--secondary-ink);
}
.brush-accent {
  display: inline-block;
  position: relative;
  padding: .35rem .85rem;
  border-radius: 1.2rem;
  background: linear-gradient(120deg, rgba(210,191,171,.3), rgba(255,255,255,.65));
  box-shadow: 0 .4rem 1.25rem rgba(0,0,0,.08);
}

.trust-badges {
  margin: 1.5rem 0 0;
  display: grid;
  gap: .8rem;
}
.trust-badges--hero {
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
}
.trust-badges--compact {
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
}
.trust-badge {
  padding: .85rem 1rem;
  border-radius: .85rem;
  background: color-mix(in oklab, white 80%, var(--accent-soft) 20%);
  border: 1px solid rgba(0,0,0,.04);
  box-shadow: 0 18px 32px -28px rgba(0,0,0,.45);
  display: flex;
  gap: .65rem;
  align-items: center;
}
.trust-badge strong { display: block; margin: 0 0 .15rem; color: var(--secondary-ink); }
.trust-badge p { margin: 0; }
.trust-badges--compact .trust-badge {
  padding: .7rem .85rem;
  font-size: .95rem;
}
.trust-icon {
  font-size: 1.4rem;
}

.portrait-card {
  margin: 2rem 0 0;
  padding: 1rem;
  border-radius: .75rem;
  background: color-mix(in oklab, #fff 70%, var(--accent-soft) 30%);
  box-shadow: 0 34px 60px -42px rgba(0,0,0,.45);
  position: relative;
  max-width: 520px;
}
.portrait-card::after,
.portrait-card::before {
  content: "";
  position: absolute;
  width: 72px;
  height: 18px;
  background: rgba(255,255,255,.85);
  top: 12px;
  border-radius: 999px;
  box-shadow: 0 8px 14px rgba(0,0,0,.15);
  opacity: .8;
}
.portrait-card::before { left: 16%; transform: rotate(-6deg); }
.portrait-card::after  { right: 16%; transform: rotate(4deg); }
.portrait-card img {
  border-radius: .5rem;
  display: block;
}

/* TOC / nav */
.toc {
  max-width: var(--page-width);
  margin: 1.5rem auto 2.5rem;
  padding-left: 0;
  list-style: none;
  border-left: 3px solid rgba(0,0,0,.08);
}
.toc li { margin: .35rem 0; padding-left: 1rem; }
.toc a { text-decoration: none; }
.toc a .num { color: var(--muted); margin-right: .5rem; }

/* Chapters */
main { counter-reset: chapter; }
.chapter {
  display: grid;
  grid-template-columns: 1fr minmax(0, var(--page-width)) 24ch 1fr;
  gap: 0 1.5rem;
  margin: 3.2rem 0;
  position: relative;
  counter-increment: chapter;
  background: var(--chapter-bg, transparent);
  border-radius: .85rem;
  padding: 2rem 0;
  box-shadow: var(--chapter-shadow, none);
}
.chapter > .content { grid-column: 2; }
.chapter > .sidenote { grid-column: 3; color: var(--muted); font-size: .9rem; }
.chapter > .sidenote p { margin: 0 0 .6rem; }
.chapter::before {
  content: "Глава " counter(chapter);
  position: absolute;
  left: calc(50% - var(--page-width)/2);
  top: .4rem;
  font: italic 500 .95rem/1.2 "Playfair Display", "Garamond", serif;
  color: var(--muted);
  opacity: .85;
}
.chapter--no-number { counter-increment: none; }
.chapter--no-number::before { content: none; }
.chapter h2 {
  font-family: "Playfair Display", "Garamond", serif;
  font-weight: 400;
  margin: 0 0 .6rem;
  font-size: clamp(1.25rem, 1.2vw + 1rem, 2rem);
  color: var(--secondary-ink);
  display: inline-block;
  padding: 0 .2rem .2rem;
  background-image: linear-gradient(120deg, rgba(210,191,171,.35), rgba(215,226,214,.35));
  background-repeat: no-repeat;
  background-size: 100% 12px;
  background-position: 0 100%;
}
.chapter p { margin: 0 0 1rem; }
.chapter ul { margin: 0 0 1rem 1.25rem; padding-left: 1.25rem; }
.chapter ul li { margin: 0 0 .5rem; }
.chapter--tint-peach { --chapter-bg: color-mix(in oklab, var(--accent-soft), transparent 40%); --chapter-shadow: 0 30px 60px -50px rgba(0,0,0,.45); }
.chapter--tint-sage  { --chapter-bg: color-mix(in oklab, var(--accent-sage), transparent 45%); --chapter-shadow: 0 30px 60px -50px rgba(0,0,0,.45); }
.chapter--tint-blue  { --chapter-bg: color-mix(in oklab, var(--accent-blue), transparent 50%); --chapter-shadow: 0 30px 60px -50px rgba(0,0,0,.45); }
.chapter--tint-paper { --chapter-bg: color-mix(in oklab, #fff8ef, transparent 30%); --chapter-shadow: 0 30px 60px -50px rgba(0,0,0,.45); }

#chapter-1,
#chapter-2,
#chapter-3,
#chapter-4,
#chapter-6,
#chapter-7 {
  --chapter-bg: color-mix(in oklab, #fff5ef, transparent 25%);
  --chapter-shadow: 0 30px 60px -50px rgba(0, 0, 0, .45);
}

#chapter-5,
#chapter-8 {
  --chapter-bg: color-mix(in oklab, #edf4fb, transparent 20%);
  --chapter-shadow: 0 30px 60px -50px rgba(0, 0, 0, .45);
}

.chapter--tint-peach,
.chapter--tint-sage,
.chapter--tint-blue,
.chapter--tint-paper {
  padding: 2.75rem 0;
}

.chapter--tint-peach::after,
.chapter--tint-sage::after,
.chapter--tint-blue::after,
.chapter--tint-paper::after {
  content: "";
  position: absolute;
  inset: 1.5rem;
  border: 1px solid rgba(0,0,0,.04);
  border-radius: .75rem;
  pointer-events: none;
}

/* Advantages / trust blocks */
.advantages-list {
  display: grid;
  gap: 1.2rem;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  margin: 1.5rem 0 0;
  padding: 0;
  list-style: none;
}
.adv-card {
  background: color-mix(in oklab, #fff 75%, var(--page-bg) 25%);
  border: 1px solid rgba(0,0,0,.05);
  border-radius: .65rem;
  padding: 1rem 1.2rem 1.1rem;
  box-shadow: 0 24px 40px -36px rgba(0,0,0,.25);
}
.adv-card h3 {
  margin: 0 0 .35rem;
  font-size: 1.05rem;
}
.adv-icon {
  display: inline-flex;
  width: 42px;
  height: 42px;
  border-radius: 50%;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  font-variant-numeric: tabular-nums;
  background: color-mix(in oklab, var(--accent), white 15%);
  color: var(--accent-ink);
  margin-bottom: .5rem;
  box-shadow: 0 10px 20px rgba(0,0,0,.1);
}

.sticker-list {
  margin: 1.25rem 0 1.8rem;
  padding: 0;
  list-style: none;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
}

.sticker {
  background: #fffef7;
  border-radius: .85rem;
  padding: 1rem 1.1rem 1.2rem;
  box-shadow: 0 26px 38px -32px rgba(0,0,0,.5);
  border: 1px solid rgba(0,0,0,.04);
  position: relative;
  color: var(--secondary-ink);
  font-weight: 500;
  line-height: 1.5;
  transform: rotate(var(--sticker-tilt, -.8deg));
  transition: box-shadow .3s ease, transform .3s ease;
  isolation: isolate;
}

.sticker strong { text-transform: none; letter-spacing: normal; }

.sticker::after {
  content: "";
  position: absolute;
  top: -.45rem;
  left: 50%;
  width: 48%;
  height: .45rem;
  background: rgba(255, 231, 171, .8);
  border-radius: 999px;
  transform: translateX(-50%) rotate(-2deg);
  box-shadow: 0 6px 10px rgba(0,0,0,.15);
  opacity: .9;
  z-index: -1;
}

.sticker-list li:nth-child(2n) { --sticker-tilt: .6deg; }
.sticker-list li:nth-child(3n) { --sticker-tilt: -.2deg; }
.sticker-list li:nth-child(4n) { --sticker-tilt: 1deg; }

.sticker:hover,
.sticker:focus-visible {
  outline: 2px solid color-mix(in oklab, var(--cta-green), white 35%);
  outline-offset: 3px;
  box-shadow: 0 32px 44px -28px rgba(0,0,0,.45);
  animation: sticker-bob .9s ease-in-out infinite;
}

@media (max-width: 720px) {
  .sticker-list {
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    padding-bottom: .35rem;
    gap: .75rem;
  }
  .sticker-list .sticker {
    min-width: 78%;
    scroll-snap-align: start;
  }
  #chapter-3 .sticker-list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    overflow: visible;
    scroll-snap-type: none;
    padding-bottom: 0;
  }
  #chapter-3 .sticker-list .sticker {
    min-width: auto;
    scroll-snap-align: unset;
  }
}

#chapter-3 .sticker {
  background: color-mix(in oklab, #fff 75%, var(--page-bg) 25%);
  border: 1px solid rgba(0,0,0,.05);
  border-radius: .65rem;
  padding: 1rem 1.2rem 1.1rem;
  box-shadow: 0 24px 40px -36px rgba(0,0,0,.25);
  transform: none;
}

#chapter-3 .sticker::after { display: none; }

#chapter-3 .sticker:hover,
#chapter-3 .sticker:focus-visible {
  animation: none;
  transform: none;
}

.cred-badges {
  margin: 1.25rem 0 0;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: .85rem;
}
.cred-badge {
  display: flex;
  align-items: center;
  gap: .65rem;
  padding: .85rem 1rem;
  border-radius: .85rem;
  border: 1px solid rgba(0,0,0,.04);
  background: color-mix(in oklab, #fff 75%, var(--accent-blue) 25%);
  box-shadow: 0 20px 34px -30px rgba(0,0,0,.4);
}
.cred-icon {
  font-size: 1.35rem;
}

@keyframes sticker-bob {
  0%   { transform: rotate(var(--sticker-tilt, 0deg)) translateY(0); }
  50%  { transform: rotate(var(--sticker-tilt, 0deg)) translateY(-6px); }
  100% { transform: rotate(var(--sticker-tilt, 0deg)) translateY(0); }
}

@media (prefers-reduced-motion: reduce) {
  .sticker {
    transition: none;
    animation: none !important;
  }
  .sticker:hover,
  .sticker:focus-visible {
    animation: none;
    transform: rotate(var(--sticker-tilt, -.8deg));
  }
}

.request-block { margin-top: 1.4rem; }
.request-block h3 { margin: 0 0 .4rem; font-size: 1.1rem; }
.request-list { margin: .4rem 0 1rem 1.1rem; padding-left: 1.1rem; }
.topics-list { list-style: none; padding-left: 0; margin-left: 0; }
.topics-list li {
  position: relative;
  padding-left: 2rem;
}
.topics-list li::before {
  content: "";
  position: absolute;
  left: 0;
  top: .4rem;
  width: 1.15rem;
  height: 1.15rem;
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.85), transparent 65%), color-mix(in oklab, var(--accent), var(--accent-blue) 35%);
  mask: radial-gradient(circle at 50% 40%, black 52%, transparent 55%);
  box-shadow: 0 10px 18px -10px rgba(0,0,0,.35);
}
.topics-list li:nth-child(2)::before { background: radial-gradient(circle at 70% 30%, rgba(255,255,255,.8), transparent 60%), color-mix(in oklab, var(--accent-sage), var(--accent-blue) 30%); }
.topics-list li:nth-child(3)::before { background: radial-gradient(circle at 20% 40%, rgba(255,255,255,.9), transparent 60%), color-mix(in oklab, var(--accent), white 15%); }
.topics-list li:nth-child(4)::before { background: radial-gradient(circle at 60% 30%, rgba(255,255,255,.85), transparent 60%), color-mix(in oklab, var(--accent-blue), var(--accent-soft) 35%); }
.topics-list li:nth-child(5)::before { background: radial-gradient(circle at 40% 30%, rgba(255,255,255,.85), transparent 60%), color-mix(in oklab, var(--accent-sage), white 20%); }

.badge-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
  margin: 1.5rem 0 0;
}
.badge {
  padding: .9rem 1rem;
  border-radius: .8rem;
  background: rgba(255,255,255,.6);
  border: 1px dashed rgba(0,0,0,.08);
  font-size: .95rem;
  box-shadow: 0 18px 30px -30px rgba(0,0,0,.5);
  position: relative;
}
.badge span {
  display: block;
  font-weight: 600;
  color: var(--secondary-ink);
}
.badge::before {
  content: "";
  position: absolute;
  top: .65rem;
  right: .65rem;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: color-mix(in oklab, var(--accent-sage), #fff 35%);
  opacity: .45;
}

.badge-grid .badge:nth-child(2)::before { background: color-mix(in oklab, var(--accent-blue), #fff 25%); }
.badge-grid .badge:nth-child(3)::before { background: color-mix(in oklab, var(--accent), #fff 30%); }
.badge-grid .badge:nth-child(4)::before { background: color-mix(in oklab, var(--accent-soft), #fff 10%); }

.blog-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 1.2rem;
  margin: 1.25rem 0 0;
}
.blog-sticker-list { grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); }
.blog-card {
  background: rgba(255,255,255,.65);
  border-radius: .75rem;
  padding: 1.1rem 1.2rem;
  border: 1px solid rgba(0,0,0,.05);
  display: flex;
  flex-direction: column;
  gap: .4rem;
  box-shadow: 0 24px 40px -34px rgba(0,0,0,.35);
}
.blog-card.sticker {
  transform: none;
  background: rgba(255,255,255,.72);
  border: 1px solid rgba(0,0,0,.06);
  box-shadow: 0 24px 40px -34px rgba(0,0,0,.35);
}
.blog-card.sticker::after { display: none; }
.blog-card.sticker:hover,
.blog-card.sticker:focus-visible {
  animation: none;
  transform: none;
}
.blog-card h3 {
  margin: 0;
  font-size: 1.05rem;
}
.blog-card p {
  margin: 0;
  color: var(--muted);
}
.blog-card a {
  margin-top: .6rem;
  font-weight: 600;
  display: inline-flex;
  align-items: center;
  gap: .35rem;
}

.rating {
  margin: .6rem 0 1rem;
  color: #d4a72c;
  font-weight: 700;
  letter-spacing: .05em;
}

.cta-inline {
  margin: 0 0 1rem;
  padding: 1rem 1.1rem;
  border-radius: .9rem;
  background: linear-gradient(135deg, rgba(210,191,171,.32), rgba(255,255,255,.9));
  border: 1px solid rgba(0,0,0,.04);
  box-shadow: 0 24px 40px -34px rgba(0,0,0,.35);
  display: grid;
  gap: .6rem;
  align-items: center;
}

.cta-inline .btn { justify-self: start; }

.testimonial-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 1rem;
  margin: 1rem 0 1.4rem;
}

@media (max-width: 720px) {
  .testimonial-grid {
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    padding-bottom: .4rem;
    gap: .75rem;
  }
  .testimonial {
    min-width: 78%;
    scroll-snap-align: start;
  }
}

.testimonial {
  margin: 0;
  padding: 1rem 1.1rem 1.2rem;
  border-radius: .85rem;
  background: #fffef7;
  border: 1px solid rgba(0,0,0,.04);
  box-shadow: 0 26px 38px -32px rgba(0,0,0,.5);
  position: relative;
  color: var(--secondary-ink);
  font-weight: 500;
  line-height: 1.5;
  transform: rotate(var(--sticker-tilt, -.8deg));
  transition: box-shadow .3s ease, transform .3s ease;
  isolation: isolate;
}

.testimonial::after {
  content: "";
  position: absolute;
  top: -.45rem;
  left: 50%;
  width: 48%;
  height: .45rem;
  background: rgba(255, 231, 171, .8);
  border-radius: 999px;
  transform: translateX(-50%) rotate(-2deg);
  box-shadow: 0 6px 10px rgba(0,0,0,.15);
  opacity: .9;
  z-index: -1;
}

.testimonial-grid .testimonial:nth-child(2n) { --sticker-tilt: .6deg; }
.testimonial-grid .testimonial:nth-child(3n) { --sticker-tilt: -.2deg; }
.testimonial-grid .testimonial:nth-child(4n) { --sticker-tilt: 1deg; }

.testimonial:hover,
.testimonial:focus-visible {
  outline: 2px solid color-mix(in oklab, var(--cta-green), white 35%);
  outline-offset: 3px;
  box-shadow: 0 32px 44px -28px rgba(0,0,0,.45);
  animation: sticker-bob .9s ease-in-out infinite;
}

.testimonial blockquote {
  margin: 0 0 .65rem;
  padding-left: 0;
  border: none;
  color: var(--secondary-ink);
  font-style: normal;
}

.testimonial figcaption {
  font-weight: 700;
  color: var(--muted);
}

.contact-list p {
  margin: .3rem 0;
}
.contact-cta {
  display: flex;
  flex-wrap: wrap;
  gap: .75rem;
  margin: 1rem 0 1.25rem;
}
.confidentiality-note {
  margin: 1rem 0;
  display: flex;
  align-items: center;
  gap: .4rem;
  color: var(--muted);
}
.contact-form-panel {
  margin: 1.5rem 0 0;
  padding: 1.25rem;
  border-radius: 1rem;
  border: 1px solid rgba(0,0,0,.05);
  background: linear-gradient(140deg, rgba(246,231,214,.5), rgba(255,255,255,.9));
  box-shadow: 0 32px 50px -40px rgba(0,0,0,.4);
}
.contact-form {
  display: grid;
  gap: .85rem;
  margin-top: .75rem;
}
.form-field {
  display: flex;
  flex-direction: column;
  gap: .35rem;
  font-weight: 600;
  color: var(--secondary-ink);
}
.form-field span { font-size: .95rem; }
.contact-form input,
.contact-form textarea {
  font: inherit;
  padding: .65rem .75rem;
  border-radius: .65rem;
  border: 1px solid rgba(0,0,0,.1);
  background: rgba(255,255,255,.95);
  resize: vertical;
}
.contact-form input:focus,
.contact-form textarea:focus {
  outline: 2px solid color-mix(in oklab, var(--cta-green), transparent 30%);
  outline-offset: 1px;
}
.form-note {
  margin: .25rem 0 0;
  font-size: .85rem;
  color: var(--muted);
}
.form-feedback {
  min-height: 1.25rem;
  font-size: .9rem;
  font-weight: 600;
}
.form-feedback.is-success { color: var(--cta-green-dark); }
.form-feedback.is-error { color: #a24949; }
.schedule-embed {
  margin: 1.75rem 0 0;
  padding: 1.2rem 1.25rem 1.35rem;
  border-radius: 1rem;
  border: 1px solid rgba(0,0,0,.05);
  background: linear-gradient(160deg, rgba(215,226,214,.5), rgba(255,255,255,.92));
  box-shadow: 0 32px 52px -42px rgba(0,0,0,.45);
}
.schedule-embed[hidden] { display: none; }
.schedule-embed__frame {
  position: relative;
  padding-top: 70%;
  border-radius: .75rem;
  overflow: hidden;
  background: rgba(0,0,0,.02);
  margin-top: .75rem;
}
.schedule-embed__frame iframe {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  border: none;
  border-radius: .75rem;
}
.snippet-recommendations {
  margin-top: 1.5rem;
  padding: 1rem 1.25rem;
  border-radius: .75rem;
  border: 1px solid rgba(0,0,0,.08);
  background: rgba(244, 239, 230, .5);
}
.snippet-recommendations h3 {
  margin-top: 0;
  margin-bottom: .35rem;
  font-size: 1.05rem;
}
.snippet-recommendations ul {
  margin: 0;
  padding-left: 1.1rem;
}
.snippet-recommendations li {
  margin-bottom: .4rem;
}

.callout {
  margin: 1.75rem 0 0;
  padding: 1.15rem 1.3rem 1.3rem;
  border-radius: .95rem;
  border: 1px solid rgba(0,0,0,.04);
  background: color-mix(in oklab, var(--accent-sage), white 70%);
  box-shadow: 0 24px 46px -36px rgba(0,0,0,.35);
}
.callout h3 {
  margin: 0 0 .35rem;
  font-size: 1.05rem;
}
.callout--peach { background: color-mix(in oklab, var(--accent-soft), white 60%); }
.callout--blue  { background: color-mix(in oklab, var(--accent-blue), white 65%); }
.callout p { margin: 0; }

.cta-banner {
  margin: 2rem 0 0;
  padding: 1.2rem 1.4rem;
  border-radius: 1rem;
  border: 1px solid rgba(0,0,0,.04);
  background: linear-gradient(120deg, rgba(210,191,171,.32), rgba(255,255,255,.92));
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: space-between;
  gap: 1rem;
  box-shadow: 0 32px 50px -40px rgba(0,0,0,.45);
}
.cta-banner h3 {
  margin: 0 0 .3rem;
}
.cta-banner p {
  margin: 0;
}

.self-check {
  margin: 1.75rem 0 0;
  padding: 1.1rem 1.2rem 1.25rem;
  border-radius: 1rem;
  background: color-mix(in oklab, #fff 75%, var(--accent-sage) 25%);
  border: 1px solid rgba(0,0,0,.04);
  box-shadow: 0 30px 48px -42px rgba(0,0,0,.4);
}
.self-check__header h3 {
  margin: 0 0 .2rem;
}
.self-check__header p {
  margin: 0 0 .75rem;
}
.checklist {
  margin: 0;
  padding: 0;
  list-style: none;
  display: grid;
  gap: .55rem;
}
.checklist label {
  display: grid;
  grid-template-columns: auto 1fr;
  align-items: center;
  gap: .55rem;
  padding: .65rem .75rem;
  border-radius: .75rem;
  background: color-mix(in oklab, #fff 85%, var(--accent-soft) 15%);
  border: 1px solid rgba(0,0,0,.04);
  box-shadow: 0 18px 32px -30px rgba(0,0,0,.35);
  cursor: pointer;
}
.checklist input[type="checkbox"] {
  accent-color: color-mix(in oklab, var(--cta-green), var(--secondary-ink) 15%);
  inline-size: 1rem;
  block-size: 1rem;
}
.self-check__cta {
  margin-top: .9rem;
  display: flex;
  align-items: center;
  gap: .8rem;
  flex-wrap: wrap;
}

.faq-list {
  margin: 1.25rem 0 0;
  display: flex;
  flex-direction: column;
  gap: .75rem;
}
.faq-list details {
  border-radius: .85rem;
  border: 1px solid rgba(0,0,0,.05);
  background: color-mix(in oklab, #fff 80%, var(--accent-soft) 20%);
  padding: .85rem 1rem;
  box-shadow: 0 24px 40px -32px rgba(0,0,0,.35);
}
.faq-list summary {
  font-weight: 600;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: .5rem;
  text-transform: none;
  letter-spacing: normal;
}
.faq-list summary::-webkit-details-marker { display: none; }
.faq-list summary::after {
  content: "⌄";
  font-size: 1.2rem;
  line-height: 1;
  transition: transform .2s ease;
  color: var(--muted);
}
.faq-list details[open] summary::after { transform: rotate(180deg); }
.faq-list p {
  margin: .5rem 0 0;
  color: var(--muted);
}

.handwritten {
  font-family: "Caveat", "Bradley Hand", cursive;
  font-size: 1.15rem;
  color: color-mix(in oklab, var(--secondary-ink), var(--accent) 25%);
  margin-top: 1.2rem;
}

.floating-cta {
  position: fixed;
  right: 1.25rem;
  bottom: 1.25rem;
  padding: .65rem 1rem;
  border-radius: 999px;
  background: var(--cta-green);
  color: #fff;
  font-weight: 600;
  text-decoration: none;
  box-shadow: 0 20px 40px rgba(0,0,0,.25);
  z-index: 950;
}
.floating-cta:hover {
  text-decoration: none;
  background: var(--cta-green-dark);
}

@media (max-width: 640px) {
  .floating-cta { bottom: .85rem; right: .85rem; }
}

/* Footnotes area */
.footnotes { 
  max-width: var(--page-width); 
  margin: 3rem auto 0; 
  border-top: 1px solid rgba(0,0,0,.08);
  padding-top: 1rem;
  color: var(--muted);
}
.footnotes ol { margin: 0; padding-left: 1.25rem; }
sup.fn-ref { font-size: .75em; vertical-align: super; }

/* Progress bar */
.progress {
  position: fixed;
  left: 0; top: 0; right: 0;
  height: 4px;
  background: var(--cta-green);
  transform: scaleX(var(--p, 0));
  transform-origin: 0 50%;
  z-index: 1000;
  opacity: .9;
  transition: transform .2s ease-out;
  box-shadow: 0 6px 18px rgba(0,0,0,.08);
}
@media (prefers-reduced-motion: reduce) {
  html { scroll-behavior: auto; }
  .progress { transition: none; }
}

/* Sticky prev/next */
.pager {
  max-width: var(--page-width);
  margin: 2.5rem auto 0;
  display: flex; justify-content: space-between; gap: 1rem;
}
.pager a {
  display: inline-block;
  padding: .6rem .9rem;
  border-radius: .35rem;
  background: rgba(0,0,0,.06);
  color: inherit;
  text-decoration: none;
}

/* Top bar (theme & toc) */
.topbar {
  position: sticky; top: 0;
  backdrop-filter: blur(4px);
  background: color-mix(in oklab, var(--page-bg), transparent 20%);
  border-bottom: 1px solid rgba(0,0,0,.06);
  z-index: 900;
}
.topbar-inner {
  max-width: var(--page-width);
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: .6rem 1rem;
  gap: 1rem;
}
.toc {
  display: flex;
  flex-wrap: wrap;
  gap: .75rem 1rem;
  margin: 0;
  padding-left: 0;
  list-style: none;
  border-left: none;
}
.toc li { margin: 0; padding-left: 0; }
.toc a {
  display: inline-flex;
  align-items: center;
  gap: .35rem;
  color: inherit;
  font-size: .9rem;
  text-decoration: none;
}
.toc a .num { color: var(--muted); font-variant-numeric: oldstyle-nums; }
.toc a:hover { text-decoration: underline; }
.page-footer {
  max-width: var(--page-width);
  margin: 1.5rem auto 2.5rem;
  text-align: center;
  color: var(--muted);
  font-size: .95rem;
  line-height: 1.6;
}
.page-footer a { color: inherit; }
@media (max-width: 640px) {
  .topbar-inner { justify-content: flex-start; padding: .35rem .55rem; }
  .toc {
    flex-wrap: nowrap;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scroll-snap-type: x proximity;
    padding: .25rem 0 .2rem;
    margin: 0;
    gap: .35rem;
  }
  .toc li { flex: 0 0 auto; scroll-snap-align: unset; }
  .toc a {
    background: rgba(0,0,0,.03);
    padding: .4rem .55rem;
    border-radius: .6rem;
    box-shadow: inset 0 0 0 1px rgba(0,0,0,.05);
    font-size: .85rem;
  }
}
.btn {
  appearance: none;
  border: 1px solid color-mix(in oklab, var(--cta-green-dark), transparent 50%);
  cursor: pointer;
  background: var(--cta-green);
  color: #fff;
  padding: .65rem 1.3rem;
  border-radius: .8rem;
  font-family: inherit;
  font-weight: 600;
  letter-spacing: .01em;
  box-shadow: 0 16px 32px rgba(0,0,0,.12);
  transition: transform .15s ease, filter .15s ease, box-shadow .2s ease;
}
.btn.highlight {
  animation: cta-pulse 2.4s ease-in-out infinite;
}
.btn.highlight:hover,
.btn.highlight:focus-visible {
  animation-play-state: paused;
}
.btn:hover,
.btn:focus-visible {
  filter: none;
  background: var(--cta-green-dark);
  transform: translateY(-1px);
  box-shadow: 0 18px 36px rgba(0,0,0,.16);
}

.btn-secondary {
  background: transparent;
  color: var(--cta-green);
  border-color: color-mix(in oklab, var(--cta-green), transparent 45%);
  box-shadow: none;
}
.btn-secondary:hover,
.btn-secondary:focus-visible {
  background: color-mix(in oklab, var(--cta-green), white 75%);
  color: var(--cta-green-dark);
}

.btn--wide {
  min-width: 220px;
  text-align: center;
}

.social-link,
.btn-submit,
.nav-menu-item {
  min-width: 44px;
  min-height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.credentials {
  margin-bottom: 1rem;
  font-size: .95rem;
}
.credentials p {
  margin: .2rem 0;
}

@keyframes cta-pulse {
  0%   { box-shadow: 0 16px 32px rgba(0,0,0,.12), 0 0 0 0 rgba(197,143,115, .45); }
  50%  { box-shadow: 0 18px 36px rgba(0,0,0,.14), 0 0 0 12px rgba(197,143,115, 0); }
  100% { box-shadow: 0 16px 32px rgba(0,0,0,.12), 0 0 0 0 rgba(197,143,115, 0); }
}

@media (max-width: 720px) {
  .cta-banner {
    flex-direction: column;
    align-items: flex-start;
  }
  .contact-cta {
    flex-direction: column;
    align-items: stretch;
  }
  .header-cta {
    flex-direction: column;
    align-items: flex-start;
  }
  .btn--wide {
    width: 100%;
  }
  .trust-badge {
    flex-direction: column;
    align-items: flex-start;
  }
  .chapter .content > p:first-of-type::first-letter {
    float: left;
    font-size: clamp(2rem, 5vw, 2.6rem);
    margin: .05rem .3rem 0 0;
  }
}

@media (prefers-reduced-motion: reduce) {
  .btn.highlight { animation: none; }
}

/* Responsive adjustments */
@media (max-width: 1024px) {
  .chapter { grid-template-columns: 1fr minmax(0, var(--page-width)) 1fr; }
  .chapter > .sidenote { grid-column: 2; margin: .5rem 0 0; }
}
@media print {
  .topbar, .progress, .pager { display: none; }
  body { background: #fff !important; color: #111 !important; }
  .book::before, .book::after { display: none; }
  a { color: #000; text-decoration: none; }
}
